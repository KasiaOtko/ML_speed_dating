df <- subset(SD, !duplicated(SD$iid), select = 70:75) %>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
attr_idx <- unique(df_long$name)
attr_val <- c('Attractiveness', 'Sincerity', 'Intelligence', 'Fun', 'Ambition', 'Shared interests')
df_long$name <- attr_val[match(df_long$name, attr_idx)]
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Attribute') + ylab('Points') + ggtitle('Distribution of importance of each attribute in a potential date (<attribute name>1_1)') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
# Waves 6 - 9:
# attr4_1 - shar4_1 have values between 0 and 10
# attr2_1 - shar2_1 OK
# attr1_2 - shar1_2 OK
which(colnames(SD) == 'age')
# Waves 6 - 9:
# attr4_1 - shar4_1 have values between 0 and 10
# attr2_1 - shar2_1 OK
# attr1_2 - shar1_2 OK
which(colnames(SD) == 'income')
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
#box <- boxplot(scale(df))
df <- as.data.frame(df)
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
attr_idx <- unique(df_long$name)
attr_val <- c('Attractiveness', 'Sincerity', 'Intelligence', 'Fun', 'Ambition', 'Shared interests')
df_long$name <- attr_val[match(df_long$name, attr_idx)]
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Attribute') + ylab('Points') + ggtitle('Distribution of importance of each attribute in a potential date (<attribute name>1_1)') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
unique(df_long$name)
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
colnames(df)
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
unique(df_long$name)
attr_idx <- unique(df_long$name)
attr_idx <- unique(df_long$name)
attr_val <- c('Attractiveness', 'Sincerity', 'Intelligence', 'Fun', 'Ambition', 'Shared interests', 'Age', 'income')
df_long$name <- attr_val[match(df_long$name, attr_idx)]
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Attribute') + ylab('Points') + ggtitle('Distribution of importance of each attribute in a potential date (<attribute name>1_1)') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
#box <- boxplot(scale(df))
df <- as.data.frame(df)
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
attr_idx <- unique(df_long$name)
attr_val <- c('Attractiveness', 'Sincerity', 'Intelligence', 'Fun', 'Ambition', 'Shared interests', 'Age', 'Income')
df_long$name <- attr_val[match(df_long$name, attr_idx)]
df_long$name <- factor(df_long$name , levels=attr_val)
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Attribute') + ylab('Points') + ggtitle('Distribution of importance of each attribute in a potential date (<attribute name>1_1)') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Attribute') + ylab('Value') + ggtitle('Distribution of chosen attributes') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
attr_idx <- unique(df_long$name)
attr_idx
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
attr_idx <- unique(df_long$name)
attr_idx
#attr_val <- c('Attractiveness', 'Sincerity', 'Intelligence', 'Fun', 'Ambition', 'Shared interests', 'Age', 'Income')
df_long$name <- attr_val[match(df_long$name, attr_idx)]
df_long$name <- factor(df_long$name , levels=attr_val)
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Attribute') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
df_long %>% ggplot(aes(x = value)) + geom_histogram(bins = 20) + facet_wrap(~ name)
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
attr_idx <- unique(df_long$name)
df_long$name <- factor(df_long$name , levels=attr_idx)
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Attribute') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15))
## Outliers
```{r}
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
attr_idx <- unique(df_long$name)
#attr_val <- c('Attractiveness', 'Sincerity', 'Intelligence', 'Fun', 'Ambition', 'Shared interests', 'Age', 'Income')
df_long$name <- attr_val[match(df_long$name, attr_idx)]
df_long$name <- factor(df_long$name , levels=attr_idx)
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
attr_idx <- unique(df_long$name)
#attr_val <- c('Attractiveness', 'Sincerity', 'Intelligence', 'Fun', 'Ambition', 'Shared interests', 'Age', 'Income')
df_long$name <- attr_val[match(df_long$name, attr_idx)]
df_long$name <- factor(df_long$name , levels=attr_idx)
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
df_long
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
attr_idx <- unique(df_long$name)
attr_idx
#attr_val <- c('Attractiveness', 'Sincerity', 'Intelligence', 'Fun', 'Ambition', 'Shared interests', 'Age', 'Income')
#df_long$name <- attr_val[match(df_long$name, attr_idx)]
df_long$name <- factor(df_long$name , levels=attr_idx)
df_long
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 20), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 20))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12),
axis.ticks.x = element_text(size = 15))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12),
axis.text.x = element_text(size = 15))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12),
axis.text.x = element_text(size = 10))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 12), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 12),
axis.text.x = element_text(size = 12))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15),
axis.text.x = element_text(size = 12))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15),
axis.text.x = element_text(size = 12),
axis.text. = element_text(size = 12))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 10))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5, size = 15), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 10))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5, size = 15), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5, size = 15), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13))
df_long %>% ggplot(aes(x = name, y = value, fill = name)) + geom_boxplot(show.legend = F) +
xlab('Feature') + ylab('Value') + ggtitle('Distribution of chosen features after scaling') +
theme_minimal() + # Changing theme
theme(plot.title = element_text(hjust = 0.5, size = 15), # Centers title
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size = 15), # x/y labels position
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size = 15),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13))
qqnorm(df$amb1_1)
qqline(df$amb1_1)
df
par(mfrow=c(2, 4))
for (i in 1:ncol(df)) {
qqnorm(df[,i])
qqline(df[,i])
}
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45))
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
df_long
df_long %>% ggplot(aes(x = name, y = value)) %>% geom_hist() %>%
facet_wrap(~name)
df_long %>% ggplot(aes(x = name, y = value)) %>% geom_histogram() %>%
facet_wrap(~name)
df_long %>% ggplot(aes(x = name, y = value)) + geom_histogram() +
facet_wrap(~name)
df_long %>% ggplot(aes(value)) + geom_histogram() +
facet_wrap(~name)
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame(
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame(
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45)) %>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
df_long %>% ggplot(aes(value)) + geom_histogram() +
facet_wrap(~name)
df_long %>% ggplot(aes(value)) + geom_histogram() +
facet_wrap(~name, ncol = 4)
plot(density(df[,1]))
df
density(df[,1])
plot(density(df[,1], na.rm = T))
df_long %>% ggplot(aes(value)) + geom_density() +
facet_wrap(~name, ncol = 4)
df_long %>% ggplot(aes(value)) + geom_histogram() +
facet_wrap(~name, ncol = 4)
df_long %>% ggplot(aes(value)) + geom_histogram(bins = 20) +
facet_wrap(~name, ncol = 4)
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45))
#%>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
par(mfrow=c(2, 4))
for (i in 1:ncol(df)) {
qqnorm(df[,i])
qqline(df[,i])
}
plot(density(df[,1], na.rm = T))
df_long %>% ggplot(aes(value)) + geom_histogram(bins = 20) +
facet_wrap(~name, ncol = 4, scales = 'free')
attr_idx <- unique(df_long$name)
df_long$name <- factor(df_long$name , levels=attr_idx)
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45))
#%>% scale() %>% as.data.frame()
df_long <- pivot_longer(df[complete.cases(df),], colnames(df))
attr_idx <- unique(df_long$name)
df_long$name <- factor(df_long$name , levels=attr_idx)
df_long %>% ggplot(aes(value)) + geom_histogram(bins = 20) +
facet_wrap(~name, ncol = 4, scales = 'free')
shapiro.test(df)
df
for(i in 1:ncol(df)) {
pvalues[i] <- shapiro.test(df[,i])$p.value
}
pvalues <- c()
for(i in 1:ncol(df)) {
pvalues[i] <- shapiro.test(df[,i])$p.value
}
pvalues
library(tseries)
install.packages('tseries')
library(tseries)
pvalues[i] <- jarque.bera.test(df[,i])$p.value
pvalues <- c()
for(i in 1:ncol(df)) {
pvalues[i] <- jarque.bera.test(df[,i])$p.value
}
pvalues <- c()
for(i in 1:ncol(df)) {
pvalues[i] <- jarque.bera.test(df[complete.cases(df),i])$p.value
}
pvalues
df_long %>% ggplot(aes(value)) + geom_histogram(bins = 20) +
facet_wrap(~name, ncol = 4, scales = 'free')
par(mfrow=c(2, 4))
for (i in 1:ncol(df)) {
hist(df[,i])
lines(cdf(df[,i]))
}
for (i in 1:ncol(df)) {
hist(df[,i])
lines(ecdf(df[,i]))
}
par(mfrow=c(2, 4))
for (i in 1:ncol(df)) {
hist(df[,i])
lines(ecdf(df[,i]))
}
lines(ecdf(df[,i])
lines(ecdf(df[,i]))
lines(ecdf(df[,i]))
lines(ecdf(df[,1]))
plot(ecdf(df[,1]))
for (i in 1:ncol(df)) {
hist(df[,i])
lines(ecdf(df[,i]))
axis(4)
}
axis(2, at = 5*(0:20), las = 1, gap.axis = 1/4)
plot(0:100, type="n", axes=FALSE, ann=FALSE)
title(quote("axis(1, .., gap.axis = f)," ~~ f >= 0))
axis(2, at = 5*(0:20), las = 1, gap.axis = 1/4)
plot(0:100, type="n", axes=FALSE, ann=FALSE)
title(quote("axis(1, .., gap.axis = f)," ~~ f >= 0))
axis(2, at = 5*(0:20), las = 1, gap.axis = 1/4)
axis(2, at = (0, 1), las = 1, gap.axis = 1/4)
plot(0:100, type="n", axes=FALSE, ann=FALSE)
title(quote("axis(1, .., gap.axis = f)," ~~ f >= 0))
axis(2, at = (0, 1), las = 1, gap.axis = 1/4)
plot(0:100, type="n", axes=FALSE, ann=FALSE)
title(quote("axis(1, .., gap.axis = f)," ~~ f >= 0))
axis(2, at = (0:1), las = 1, gap.axis = 1/4)
axis(2, at = (0:1, length.out = 11), las = 1, gap.axis = 1/4)
axis(2, at = seq(0, 1, 11), las = 1, gap.axis = 1/4)
plot(0:100, type="n", axes=FALSE, ann=FALSE)
title(quote("axis(1, .., gap.axis = f)," ~~ f >= 0))
axis(2, at = seq(0, 1, 11), las = 1, gap.axis = 1/4)
plot(0:100, type="n", axes=FALSE, ann=FALSE)
title(quote("axis(1, .., gap.axis = f)," ~~ f >= 0))
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
plot(0:100, type="n", axes=FALSE, ann=FALSE)
title(quote("axis(1, .., gap.axis = f)," ~~ f >= 0))
axis(4, at=seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
for (i in 1:ncol(df)) {
h <- hist(df[,i])
#lines(ecdf(df[,i]))
#axis(4, at = seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
plot(x = h$mids, y=ec(h$mids)*max(h$counts), col = rgb(0,0,0,alpha=0), axes=F, xlab=NA, ylab=NA)
lines(x = h$mids, y=ec(h$mids)*max(h$counts), col ='red')
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
mtext(side = 4, line = 3, 'Cumulative Density', col = 'red')
}
for (i in 1:ncol(df)) {
h <- hist(df[,i])
ec <- ecdf(df[,i]))
#axis(4, at = seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
plot(x = h$mids, y=ec(h$mids)*max(h$counts), col = rgb(0,0,0,alpha=0), axes=F, xlab=NA, ylab=NA)
lines(x = h$mids, y=ec(h$mids)*max(h$counts), col ='red')
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
mtext(side = 4, line = 3, 'Cumulative Density', col = 'red')
}
for (i in 1:ncol(df)) {
h <- hist(df[,i])
ec <- ecdf(df[,i])
#axis(4, at = seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
plot(x = h$mids, y=ec(h$mids)*max(h$counts), col = rgb(0,0,0,alpha=0), axes=F, xlab=NA, ylab=NA)
lines(x = h$mids, y=ec(h$mids)*max(h$counts), col ='red')
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
mtext(side = 4, line = 3, 'Cumulative Density', col = 'red')
}
par(mfrow=c(2, 4))
for (i in 1:ncol(df)) {
h <- hist(df[,i])
ec <- ecdf(df[,i])
#axis(4, at = seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
plot(x = h$mids, y=ec(h$mids)*max(h$counts), col = rgb(0,0,0,alpha=0), axes=F, xlab=NA, ylab=NA)
lines(x = h$mids, y=ec(h$mids)*max(h$counts), col ='red')
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
mtext(side = 4, line = 3, 'Cumulative Density', col = 'red')
}
for (i in 1:ncol(df)) {
h <- hist(df[,i])
ec <- ecdf(df[,i])
#axis(4, at = seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
plot(x = h$mids, y=ec(h$mids)*max(h$counts), col = rgb(0,0,0,alpha=0), axes=F, xlab=NA, ylab=NA)
lines(x = h$mids, y=ec(h$mids)*max(h$counts), col ='red')
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
#(side = 4, line = 3, 'Cumulative Density', col = 'red')
}
for (i in 1:ncol(df)) {
h <- hist(df[,i])
ec <- ecdf(df[,i])
#axis(4, at = seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
plot(x = h$mids, y=ec(h$mids)*max(h$counts), col = rgb(0,0,0,alpha=0), axes=F, xlab=NA, ylab=NA)
#lines(x = h$mids, y=ec(h$mids)*max(h$counts), col ='red')
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
#(side = 4, line = 3, 'Cumulative Density', col = 'red')
}
for (i in 1:ncol(df)) {
h <- hist(df[,i])
ec <- ecdf(df[,i])
#axis(4, at = seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
#plot(x = h$mids, y=ec(h$mids)*max(h$counts), col = rgb(0,0,0,alpha=0), axes=F, xlab=NA, ylab=NA)
lines(x = h$mids, y=ec(h$mids)*max(h$counts), col ='red')
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
#(side = 4, line = 3, 'Cumulative Density', col = 'red')
}
h$counts
pvalues <- c()
for(i in 1:ncol(df)) {
pvalues[i] <- jarque.bera.test(log(df[complete.cases(df),i]))$p.value
}
pvalues
df <- subset(SD, !duplicated(SD$iid), select = c(70:75, 34, 45))
pvalues <- c()
for(i in 1:ncol(df)) {
pvalues[i] <- jarque.bera.test(log(df[complete.cases(df),i]))$p.value
}
pvalues
for (i in 1:ncol(df)) {
h <- hist(log(df[,i]))
ec <- ecdf(df[,i])
#axis(4, at = seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
#plot(x = h$mids, y=ec(h$mids)*max(h$counts), col = rgb(0,0,0,alpha=0), axes=F, xlab=NA, ylab=NA)
lines(x = h$mids, y = ec(h$mids)*max(h$counts), col ='red')
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
#(side = 4, line = 3, 'Cumulative Density', col = 'red')
}
for (i in 1:ncol(df)) {
h <- hist(log(df[,i]))
ec <- ecdf(log(df[,i]))
#axis(4, at = seq(from = 0, to = 30, length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
#plot(x = h$mids, y=ec(h$mids)*max(h$counts), col = rgb(0,0,0,alpha=0), axes=F, xlab=NA, ylab=NA)
lines(x = h$mids, y = ec(h$mids)*max(h$counts), col ='red')
axis(4, at=seq(from = 0, to = max(h$counts), length.out = 11), labels=seq(0, 1, 0.1), col = 'red', col.axis = 'red')
#(side = 4, line = 3, 'Cumulative Density', col = 'red')
}
pvalues[i] <- shapiro.test(df[complete.cases(df),i])$p.value
pvalues <- c()
for(i in 1:ncol(df)) {
pvalues[i] <- shapiro.test(df[complete.cases(df),i])$p.value
}
pvalues
